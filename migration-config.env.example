# Migration Configuration Template
# Copy this file to migration-config.env and fill in your values
# Then run: ./migrate-to-new-server.sh --config migration-config.env

# ============================================================================
# Old (Source) AWS Account Configuration
# ============================================================================

# AWS CLI profile name for old account
# This should be configured with: aws configure --profile <name>
OLD_AWS_PROFILE="default"

# AWS region where the old S3 bucket is located
OLD_AWS_REGION="ap-south-1"

# Name of the old S3 bucket to migrate from
OLD_S3_BUCKET="peptide-bucket"

# ============================================================================
# New (Target) AWS Account Configuration
# ============================================================================

# AWS CLI profile name for new account
# This should be configured with: aws configure --profile <name>
NEW_AWS_PROFILE="new-account"

# AWS region where the new S3 bucket should be created/located
NEW_AWS_REGION="us-east-1"

# Name of the new S3 bucket to migrate to
# This bucket will be created if it doesn't exist
NEW_S3_BUCKET="peptides-new-bucket"

# ============================================================================
# Database Configuration
# ============================================================================

# Database host (IP or hostname)
# For local Docker: localhost
# For remote: IP address or domain name
DB_HOST="localhost"

# Database port
# Default for docker-compose.staging.yaml: 5444
# Default PostgreSQL port: 5432
DB_PORT="5444"

# Database name
DB_NAME="peptides_db"

# Database user
DB_USER="peptides_user"

# Database password
# NOTE: For security, password is NOT stored in this file
# You will be prompted for the password when running the script
# DB_PASSWORD will be asked interactively

# ============================================================================
# Notes
# ============================================================================

# 1. Ensure AWS CLI is configured with both profiles:
#    aws configure --profile old-account
#    aws configure --profile new-account

# 2. Verify access to old bucket:
#    aws s3 ls s3://peptide-bucket --profile default --region ap-south-1

# 3. Verify access to new account:
#    aws s3 ls --profile new-account

# 4. Make sure database is accessible:
#    psql -h localhost -p 5444 -U peptides_user -d peptides_db

# 5. Required IAM permissions:
#    Old Account: s3:ListBucket, s3:GetObject
#    New Account: s3:CreateBucket, s3:PutObject, s3:ListBucket

# ============================================================================
# Usage Examples
# ============================================================================

# Run migration with this config:
# ./migrate-to-new-server.sh --config migration-config.env

# Dry run to test:
# ./migrate-to-new-server.sh --config migration-config.env --dry-run

# Skip certain steps:
# ./migrate-to-new-server.sh --config migration-config.env --skip-db
# ./migrate-to-new-server.sh --config migration-config.env --skip-s3
